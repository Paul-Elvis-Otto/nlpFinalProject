<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>REP or DEM   LSTM classification report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8a894fcc3cb5e37eb5bf30def131be2f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="REP or DEM &amp;amp;lt;br&amp;gt; LSTM classification report">
<meta name="citation_author" content="Paul Elvis Otto">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Literate programming;,citation_author=Donald E. Knuth;,citation_publication_date=1984-05;,citation_cover_date=1984-05;,citation_year=1984;,citation_fulltext_html_url=https://doi.org/10.1093/comjnl/27.2.97;,citation_issue=2;,citation_doi=10.1093/comjnl/27.2.97;,citation_issn=0010-4620;,citation_volume=27;,citation_journal_title=Comput. J.;,citation_publisher=Oxford University Press, Inc.;">
</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">REP or DEM <br> LSTM classification report</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Author</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Paul Elvis Otto </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Duke University / Hertie School
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></p></div><div class="quarto-title-meta-contents"><p><a href="index.pdf"><i class="bi bi-file-pdf"></i>Typst</a></p></div><div class="quarto-title-meta-contents"><p><a href="index-meca.zip" data-meca-link="true"><i class="bi bi-archive"></i>MECA Bundle</a></p></div></div></div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#sec-data-prep" id="toc-sec-data-prep" class="nav-link" data-scroll-target="#sec-data-prep">Data Preparation</a></li>
  <li><a href="#sec-eda" id="toc-sec-eda" class="nav-link" data-scroll-target="#sec-eda">EDA</a></li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification">Model specification</a>
  <ul class="collapse">
  <li><a href="#tokenization-and-inputs" id="toc-tokenization-and-inputs" class="nav-link" data-scroll-target="#tokenization-and-inputs">Tokenization and inputs</a></li>
  <li><a href="#trainable-embedding-layer" id="toc-trainable-embedding-layer" class="nav-link" data-scroll-target="#trainable-embedding-layer">Trainable embedding layer</a></li>
  <li><a href="#bidirectional-lstm-encoder" id="toc-bidirectional-lstm-encoder" class="nav-link" data-scroll-target="#bidirectional-lstm-encoder">Bidirectional LSTM encoder</a></li>
  <li><a href="#masked-mean-pooling" id="toc-masked-mean-pooling" class="nav-link" data-scroll-target="#masked-mean-pooling">Masked mean pooling</a></li>
  <li><a href="#classification-head" id="toc-classification-head" class="nav-link" data-scroll-target="#classification-head">Classification head</a></li>
  <li><a href="#training-objective" id="toc-training-objective" class="nav-link" data-scroll-target="#training-objective">Training objective</a></li>
  <li><a href="#computational-considerations" id="toc-computational-considerations" class="nav-link" data-scroll-target="#computational-considerations">Computational considerations</a></li>
  </ul></li>
  <li><a href="#implementation-details" id="toc-implementation-details" class="nav-link" data-scroll-target="#implementation-details">Implementation details</a>
  <ul class="collapse">
  <li><a href="#environment-and-reproducibility" id="toc-environment-and-reproducibility" class="nav-link" data-scroll-target="#environment-and-reproducibility">Environment and reproducibility</a></li>
  </ul></li>
  <li><a href="#data-pipeline" id="toc-data-pipeline" class="nav-link" data-scroll-target="#data-pipeline">Data Pipeline</a>
  <ul class="collapse">
  <li><a href="#training-loop" id="toc-training-loop" class="nav-link" data-scroll-target="#training-loop">Training Loop</a></li>
  </ul></li>
  <li><a href="#sec-nbb" id="toc-sec-nbb" class="nav-link" data-scroll-target="#sec-nbb">Naive Bayes Baseline</a>
  <ul class="collapse">
  <li><a href="#model-description" id="toc-model-description" class="nav-link" data-scroll-target="#model-description">Model description</a></li>
  <li><a href="#baseline-evaluation" id="toc-baseline-evaluation" class="nav-link" data-scroll-target="#baseline-evaluation">Baseline evaluation</a></li>
  </ul></li>
  <li><a href="#empirical-assessments" id="toc-empirical-assessments" class="nav-link" data-scroll-target="#empirical-assessments">Empirical Assessments</a>
  <ul class="collapse">
  <li><a href="#headline-results" id="toc-headline-results" class="nav-link" data-scroll-target="#headline-results">Headline results</a></li>
  <li><a href="#class-wise-metrics" id="toc-class-wise-metrics" class="nav-link" data-scroll-target="#class-wise-metrics">Class-wise metrics</a></li>
  <li><a href="#confusion-matrix-and-derived-rates" id="toc-confusion-matrix-and-derived-rates" class="nav-link" data-scroll-target="#confusion-matrix-and-derived-rates">Confusion matrix and derived rates</a></li>
  <li><a href="#error-profile" id="toc-error-profile" class="nav-link" data-scroll-target="#error-profile">Error profile</a></li>
  <li><a href="#comparative-perspective" id="toc-comparative-perspective" class="nav-link" data-scroll-target="#comparative-perspective">Comparative perspective</a></li>
  </ul></li>
  <li><a href="#limitations-and-possible-extensions" id="toc-limitations-and-possible-extensions" class="nav-link" data-scroll-target="#limitations-and-possible-extensions">Limitations and possible extensions</a>
  <ul class="collapse">
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  <li><a href="#extensions" id="toc-extensions" class="nav-link" data-scroll-target="#extensions">Extensions</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="index-preview.html"><i class="bi bi-journal-code"></i>Article Notebook</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>Classifiying tweets is probably one the most done tasks in machine learining. This project classifiest tweets of the 112th congres into either being macde by a democrat or a republican. The dataset is taken from the harvard dataverse and contains the posts themself, the author of it, the party affiliation and whether the post was made in the house or the senate.</p>
<p>For the classficiaitn task a bidirectional LSTM has been used, which is described in the model section. The model is trained from scratch without any pretraining. For the classification embeddings are used which have been imported from huggingface. As a baseliune a naive bayes classifier has been used the comparison is shown in the empirical assessment section.</p>
<p>To get an overall impression of the dataset an EDA has been performed, which is shown in <a href="#sec-eda" class="quarto-xref">Section&nbsp;3</a>.</p>
<p>The dataset has been cleaned for the processing by the BILSTM, more detail in <a href="#sec-data-prep" class="quarto-xref">Section&nbsp;2</a>.</p>
</section>
<section id="sec-data-prep" class="level2">
<h2 class="anchored" data-anchor-id="sec-data-prep">Data Preparation</h2>
<p>To make the data workable and not conditionn on things like dates, mentios or links the posts each have been cleaned from that with the help of different regexes. The script to cleaning can be view in the repository of the model. The scope of the cleanned data is as follwos:</p>
<ul>
<li>DAtes removed</li>
<li>Mentions removed</li>
<li>Hashtags removed</li>
</ul>
</section>
<section id="sec-eda" class="level2">
<h2 class="anchored" data-anchor-id="sec-eda">EDA</h2>
<p>To give an insisht into the dataset first there are some basic metrics</p>
<p>The dataset has the shape of 334606, 5 and the posts are distributed as follows:</p>
<p>The overall distribution of posts by chamber and party is shown in <a href="#fig-post-dist" class="quarto-xref">Figure&nbsp;1</a> .</p>
<div id="cell-fig-post-dist" class="cell">
<div class="cell-output-display">
<div id="fig-post-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-post-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-post-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Distribution of posts by chamber and party"><img src="index_files/figure-html/fig-post-dist-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-post-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution of posts by chamber and party
</figcaption>
</figure>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="index-preview.html#cell-fig-post-dist">Source: Article Notebook</a></div>
<p>In totatl numbers the posts per party are as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div id="uvwbajtdwn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uvwbajtdwn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uvwbajtdwn thead, #uvwbajtdwn tbody, #uvwbajtdwn tfoot, #uvwbajtdwn tr, #uvwbajtdwn td, #uvwbajtdwn th {
  border-style: none;
}

#uvwbajtdwn p {
  margin: 0;
  padding: 0;
}

#uvwbajtdwn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uvwbajtdwn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uvwbajtdwn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uvwbajtdwn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uvwbajtdwn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uvwbajtdwn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uvwbajtdwn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uvwbajtdwn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uvwbajtdwn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uvwbajtdwn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uvwbajtdwn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uvwbajtdwn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uvwbajtdwn .gt_spanner_row {
  border-bottom-style: hidden;
}

#uvwbajtdwn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uvwbajtdwn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uvwbajtdwn .gt_from_md > :first-child {
  margin-top: 0;
}

#uvwbajtdwn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uvwbajtdwn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uvwbajtdwn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uvwbajtdwn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uvwbajtdwn .gt_row_group_first td {
  border-top-width: 2px;
}

#uvwbajtdwn .gt_row_group_first th {
  border-top-width: 2px;
}

#uvwbajtdwn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvwbajtdwn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uvwbajtdwn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uvwbajtdwn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uvwbajtdwn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvwbajtdwn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uvwbajtdwn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uvwbajtdwn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uvwbajtdwn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uvwbajtdwn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uvwbajtdwn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvwbajtdwn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uvwbajtdwn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uvwbajtdwn .gt_left {
  text-align: left;
}

#uvwbajtdwn .gt_center {
  text-align: center;
}

#uvwbajtdwn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uvwbajtdwn .gt_font_normal {
  font-weight: normal;
}

#uvwbajtdwn .gt_font_bold {
  font-weight: bold;
}

#uvwbajtdwn .gt_font_italic {
  font-style: italic;
}

#uvwbajtdwn .gt_super {
  font-size: 65%;
}

#uvwbajtdwn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uvwbajtdwn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uvwbajtdwn .gt_indent_1 {
  text-indent: 5px;
}

#uvwbajtdwn .gt_indent_2 {
  text-indent: 10px;
}

#uvwbajtdwn .gt_indent_3 {
  text-indent: 15px;
}

#uvwbajtdwn .gt_indent_4 {
  text-indent: 20px;
}

#uvwbajtdwn .gt_indent_5 {
  text-indent: 25px;
}

#uvwbajtdwn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uvwbajtdwn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border">Number of Posts by Chamber and Party</th>
</tr>
<tr class="gt_col_headings even">
<th id="a::stub" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="democrat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">democrat</th>
<th id="republican" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">republican</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td id="stub_1_1" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">house</td>
<td class="gt_row gt_right" headers="stub_1_1 democrat">89808</td>
<td class="gt_row gt_right" headers="stub_1_1 republican">167004</td>
</tr>
<tr class="even">
<td id="stub_1_2" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">senate</td>
<td class="gt_row gt_right" headers="stub_1_2 democrat">37890</td>
<td class="gt_row gt_right" headers="stub_1_2 republican">39904</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The distribution of post lengths is as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>The top posters in the dataset:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Some word frequencies by party</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-specification" class="level2">
<h2 class="anchored" data-anchor-id="model-specification">Model specification</h2>
<section id="tokenization-and-inputs" class="level3">
<h3 class="anchored" data-anchor-id="tokenization-and-inputs">Tokenization and inputs</h3>
<p>Each text is mapped to a fixed-length sequence of subword token identifiers using a WordPiece-style tokenizer with vocabulary size <span class="math inline">V</span>. After padding or truncation to length <span class="math inline">T=128</span>, each sample is represented by:</p>
<p><span id="eq-token-seq"><span class="math display">
\mathbf{t}=(t_1,\dots,t_T),\quad t_i \in \{1,\dots,V\},
\tag{1}</span></span></p>
<p>and a binary mask</p>
<p><span id="eq-mask-seq"><span class="math display">
\mathbf{m}=(m_1,\dots,m_T),\quad m_i\in\{0,1\},
\tag{2}</span></span></p>
<p>where <span class="math inline">m_i=1</span> indicates a true token and <span class="math inline">m_i=0</span> indicates padding. The tokenizer is used only to obtain indices; semantic representations are learned by the network.</p>
</section>
<section id="trainable-embedding-layer" class="level3">
<h3 class="anchored" data-anchor-id="trainable-embedding-layer">Trainable embedding layer</h3>
<p>Let <span class="math inline">E\in\mathbb{R}^{V\times d}</span> be the embedding matrix with <span class="math inline">d=200</span>. Tokens are embedded as</p>
<p><span id="eq-embed-seq"><span class="math display">
\mathbf{x}_i = E[t_i]\in\mathbb{R}^{d},
\quad
\mathbf{X}=(\mathbf{x}_1,\dots,\mathbf{x}_T)\in\mathbb{R}^{T\times d}.
\tag{3}</span></span></p>
<p>The padding index is set so that padded positions do not update embeddings.</p>
</section>
<section id="bidirectional-lstm-encoder" class="level3">
<h3 class="anchored" data-anchor-id="bidirectional-lstm-encoder">Bidirectional LSTM encoder</h3>
<p>A forward LSTM and a backward LSTM encode <span class="math inline">\mathbf{X}</span>. For a single LSTM direction, gates and state updates at timestep <span class="math inline">i</span> are:</p>
<p><span id="eq-lstm-gates"><span class="math display">
\begin{align}
\mathbf{i}_i &amp;= \sigma(W_i\mathbf{x}_i + U_i\mathbf{h}_{i-1} + \mathbf{b}_i), \\
\mathbf{f}_i &amp;= \sigma(W_f\mathbf{x}_i + U_f\mathbf{h}_{i-1} + \mathbf{b}_f), \\
\mathbf{o}_i &amp;= \sigma(W_o\mathbf{x}_i + U_o\mathbf{h}_{i-1} + \mathbf{b}_o), \\
\tilde{\mathbf{c}}_i &amp;= \tanh(W_c\mathbf{x}_i + U_c\mathbf{h}_{i-1} + \mathbf{b}_c), \\
\mathbf{c}_i &amp;= \mathbf{f}_i\odot \mathbf{c}_{i-1} + \mathbf{i}_i\odot \tilde{\mathbf{c}}_i, \\
\mathbf{h}_i &amp;= \mathbf{o}_i\odot \tanh(\mathbf{c}_i),
\end{align}
\tag{4}</span></span></p>
<p>with sigmoid <span class="math inline">\sigma(\cdot)</span> and elementwise product <span class="math inline">\odot</span>. The hidden size is <span class="math inline">H=128</span> per direction. The bidirectional representation at position <span class="math inline">i</span> is</p>
<p><span id="eq-bilstm-concat"><span class="math display">
\mathbf{h}_i = [\overrightarrow{\mathbf{h}}_i ; \overleftarrow{\mathbf{h}}_i] \in \mathbb{R}^{2H},
\tag{5}</span></span></p>
<p>yielding a sequence output</p>
<p><span id="eq-seq-output"><span class="math display">
\mathbf{H}=(\mathbf{h}_1,\dots,\mathbf{h}_T)\in\mathbb{R}^{T\times 2H}.
\tag{6}</span></span></p>
</section>
<section id="masked-mean-pooling" class="level3">
<h3 class="anchored" data-anchor-id="masked-mean-pooling">Masked mean pooling</h3>
<p>To obtain a fixed-dimensional vector while excluding padding, the model computes:</p>
<p><span id="eq-fix-dim-vex"><span class="math display">
\mathbf{z}=
\frac{\sum_{i=1}^{T} m_i \mathbf{h}_i}
{\sum_{i=1}^{T} m_i + \varepsilon}
\in\mathbb{R}^{2H},
\tag{7}</span></span></p>
<p>where <span class="math inline">\varepsilon</span> is a small constant to avoid division by zero.</p>
</section>
<section id="classification-head" class="level3">
<h3 class="anchored" data-anchor-id="classification-head">Classification head</h3>
<p>Dropout is applied to <span class="math inline">\mathbf{z}</span> with probability <span class="math inline">p=0.2</span>:</p>
<p><span class="math display">
\tilde{\mathbf{z}}=\mathrm{Dropout}(\mathbf{z}).
</span></p>
<p>A linear layer produces logits:</p>
<p><span class="math display">
\mathbf{o}=W\tilde{\mathbf{z}}+\mathbf{b}\in\mathbb{R}^{2}.
</span></p>
<p>The predictive distribution is</p>
<p><span class="math display">
\hat{\mathbf{y}}=\mathrm{softmax}(\mathbf{o}),
\qquad
\hat{y}=\arg\max_{k\in\{0,1\}} \hat{\mathbf{y}}_k.
</span></p>
</section>
<section id="training-objective" class="level3">
<h3 class="anchored" data-anchor-id="training-objective">Training objective</h3>
<p>Parameters <span class="math inline">\theta</span> are learned by minimizing the cross-entropy loss:</p>
<p><span class="math display">
\mathcal{L}(\theta)
-\frac{1}{N}
\sum_{n=1}^{N}
\log \hat{\mathbf{y}}^{(n)}_{y^{(n)}}.
</span></p>
<p>Optimization uses AdamW with learning rate <span class="math inline">10^{-3}</span>. Mixed-precision training (automatic casting to FP16 with dynamic gradient scaling) is employed to improve throughput and numerical stability on modern GPUs.</p>
</section>
<section id="computational-considerations" class="level3">
<h3 class="anchored" data-anchor-id="computational-considerations">Computational considerations</h3>
<p>For each batch, the dominant cost arises from the BiLSTM. For sequence length <span class="math inline">T</span> and hidden size <span class="math inline">H</span>, time complexity scales as <span class="math inline">\mathcal{O}(T\cdot H^2)</span> per direction, and memory scales as <span class="math inline">\mathcal{O}(T\cdot H)</span> for storing activations. Fixing <span class="math inline">T=128</span> stabilizes runtime and enables cuDNN kernel autotuning.</p>
</section>
</section>
<section id="implementation-details" class="level2">
<h2 class="anchored" data-anchor-id="implementation-details">Implementation details</h2>
<section id="environment-and-reproducibility" class="level3">
<h3 class="anchored" data-anchor-id="environment-and-reproducibility">Environment and reproducibility</h3>
<p>Training is performed on CUDA hardware with cuDNN benchmarking activated, selecting optimized kernels for the fixed tensor shapes. Random seeds are set for Python, NumPy, and PyTorch (CPU and GPU) to reduce run-to-run variation.</p>
</section>
</section>
<section id="data-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="data-pipeline">Data Pipeline</h2>
<p>The pipeline proceeds as:</p>
<ul>
<li>Read CSV and keep relevant columns (text and party label).</li>
<li>Remove missing rows and normalize party strings.</li>
<li>Map party strings into binary labels and filter all others.</li>
<li>Stratified splitting into train/validation/test (80/10/10).</li>
<li>Pre-tokenize each split to input IDs and masks.</li>
</ul>
<p>Pre-tokenization on CPU in large minibatches amortizes tokenizer overhead and prevents GPU under-utilization during training.</p>
<section id="training-loop" class="level3">
<h3 class="anchored" data-anchor-id="training-loop">Training Loop</h3>
<p>The training routine iterates for 10 epochs. Each epoch consists of:</p>
<ul>
<li>Forward pass with autocasting.</li>
<li>Cross-entropy loss computation.</li>
<li>Backward pass on scaled loss.</li>
<li>AdamW parameter update.</li>
</ul>
<p>Model selection is based on validation accuracy; the best validation checkpoint is stored and reloaded before final test evaluation. DataLoaders use batch size <span class="math inline">256</span> with pinned memory and persistent workers for efficient host-device transfer.</p>
</section>
</section>
<section id="sec-nbb" class="level2">
<h2 class="anchored" data-anchor-id="sec-nbb">Naive Bayes Baseline</h2>
<p>As a classical probabilistic benchmark, a Naive Bayes classifier is employed alongside the neural sequence model. To ensure comparability, all preprocessing steps prior to feature extraction—data cleaning, label normalization, and the exact train/validation/test split—are identical to those used for the BiLSTM classifier.</p>
<section id="model-description" class="level3">
<h3 class="anchored" data-anchor-id="model-description">Model description</h3>
<p>In contrast to the sequence-based neural architecture, the Naive Bayes model operates on a sparse bag-of-ngrams representation of the text. Each document <span class="math inline">x</span> is mapped to a TF–IDF feature vector <span class="math display">
\mathbf{f}(x) = (f_1, f_2, \ldots, f_d),
</span></p>
<p>where each <span class="math inline">f_j</span> reflects the TF–IDF weight of term <span class="math inline">j</span> after vocabulary truncation and filtering. The vectorizer uses standard preprocessing settings for text classification:</p>
<ul>
<li>lowercasing,</li>
<li>English stop-word removal,</li>
<li>unigram and bigram features ((1,2)),</li>
<li>a maximum feature cap of (d = 50{,}000),</li>
<li>a minimum document frequency of (2).</li>
</ul>
<p>The classifier itself is a Multinomial Naive Bayes model, which assumes conditional independence of features given a class label <span class="math inline">y\in{0,1}</span>. Under this assumption, the likelihood of observing the feature vector <span class="math inline">\mathbf{f}(x)</span> given class <span class="math inline">k</span> factorizes as</p>
<p><span class="math display">
p(\mathbf{f}(x)\mid y=k)
;\propto;
\prod_{j=1}^{d}
\theta_{kj}^{, f_j(x)},
</span></p>
<p>where <span class="math inline">\theta_{kj}</span> are class-conditional feature probabilities estimated from the training set. Bayes’ rule then yields the posterior</p>
<p><span class="math display">
p(y=k \mid x)
;\propto;
p(y=k)\prod_{j=1}^{d}\theta_{kj}^{, f_j(x)},
</span></p>
<p>and prediction is made via</p>
<p><span class="math display">
\hat{y} = \arg\max_{k\in{0,1}} p(y=k\mid x).
</span></p>
<p>Although the multinomial model is derived for count data, it is widely used with TF–IDF features and remains a strong linear baseline in high-dimensional text classification.</p>
</section>
<section id="baseline-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="baseline-evaluation">Baseline evaluation</h3>
<p>Evaluated on the held-out test set, the Naive Bayes classifier achieves an accuracy of</p>
<p><span class="math display">
\text{Test accuracy} = 0.8447.
</span></p>
<p>This performance is slightly below that of the BiLSTM model yet remains strong given its simplicity and lack of contextual or sequential modeling.</p>
<p>A detailed breakdown of class-wise test metrics is as follows:</p>
<ul>
<li><p><strong>Class 0</strong> (Democrat) precision: (0.8258), recall: (0.7517), F1: (0.7870), support: (12{,}770)</p></li>
<li><p><strong>Class 1</strong> (Republican) precision: (0.8548), recall: (0.9021), F1: (0.8778), support: (20{,}691)</p></li>
</ul>
<p>The model shows a pronounced asymmetry: recall for class 1 is high (0.9021), whereas class-0 recall is comparatively low (0.7517). This indicates a stronger tendency to classify documents as class 1, consistent with the underlying class imbalance and the linear nature of the decision boundary.</p>
<p>The test confusion matrix <span class="math display">
\begin{pmatrix}
9599 &amp; 3171 \
2025 &amp; 18666
\end{pmatrix}
</span></p>
<p>reveals that false positives for class 1 (3171 cases) are moderately higher than in the BiLSTM model. False negatives for class 1 (2025 cases) are identical for both models, an artifact of the fixed data split.</p>
<p>Overall, the Naive Bayes baseline provides a meaningful reference point: it captures strong lexical signals and performs well with minimal computational cost, yet falls short of the sequence model in reducing class-specific error rates and balancing performance across labels.</p>
</section>
</section>
<section id="empirical-assessments" class="level2">
<h2 class="anchored" data-anchor-id="empirical-assessments">Empirical Assessments</h2>
<section id="headline-results" class="level3">
<h3 class="anchored" data-anchor-id="headline-results">Headline results</h3>
<p>On the test partition, the model achieves:</p>
<p><span class="math display">
\text{Test loss}=0.3307,\qquad
\text{Test accuracy}=0.8635.
</span></p>
<p>The closeness of validation-selected performance and test performance indicates stable generalization without severe overfitting.</p>
</section>
<section id="class-wise-metrics" class="level3">
<h3 class="anchored" data-anchor-id="class-wise-metrics">Class-wise metrics</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Test-set classification report.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Class</th>
<th style="text-align: right;">Precision</th>
<th style="text-align: right;">Recall</th>
<th style="text-align: right;">F1</th>
<th style="text-align: right;">Support</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.8347</td>
<td style="text-align: right;">0.8008</td>
<td style="text-align: right;">0.8174</td>
<td style="text-align: right;">12770</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.8801</td>
<td style="text-align: right;">0.9021</td>
<td style="text-align: right;">0.8910</td>
<td style="text-align: right;">20691</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: right;">0.8635</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">33461</td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro avg</td>
<td style="text-align: right;">0.8574</td>
<td style="text-align: right;">0.8515</td>
<td style="text-align: right;">0.8542</td>
<td style="text-align: right;">33461</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Weighted avg</td>
<td style="text-align: right;">0.8627</td>
<td style="text-align: right;">0.8635</td>
<td style="text-align: right;">0.8629</td>
<td style="text-align: right;">33461</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Performance is stronger for class <span class="math inline">1</span>, consistent with its higher prevalence. The macro-averaged F<span class="math inline">_1</span> is slightly lower than the weighted average, reflecting imbalance-driven asymmetry.</p>
</section>
<section id="confusion-matrix-and-derived-rates" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix-and-derived-rates">Confusion matrix and derived rates</h3>
<p><span class="math display">
\mathbf{C}=
\begin{pmatrix}
10226 &amp; 2544\\
2025 &amp; 18666
\end{pmatrix}.
</span></p>
<p>Key derived quantities (treating class <span class="math inline">1</span> as positive) are:</p>
<p><span class="math display">
\begin{align}
\text{TPR (recall$_1$)} &amp;= \frac{18666}{18666+2025}=0.9021, \\
\text{TNR (specificity)} &amp;= \frac{10226}{10226+2544}=0.8008, \\
\text{FPR} &amp;= \frac{2544}{10226+2544}=0.1992, \\
\text{FNR} &amp;= \frac{2025}{18666+2025}=0.0979, \\
\text{Balanced accuracy} &amp;= \frac{0.9021+0.8008}{2}=0.8515, \\
\text{MCC} &amp;= 0.7088.
\end{align}
</span></p>
</section>
<section id="error-profile" class="level3">
<h3 class="anchored" data-anchor-id="error-profile">Error profile</h3>
<p>Inspection of the confusion matrix suggests two dominant error types:</p>
<ul>
<li><p>Class-0 <span class="math inline">\rightarrow</span> Class-1 errors (2544 cases) likely driven by lexical overlap or stylistic convergence in the two parties’ rhetoric, aggravated by class imbalance.</p></li>
<li><p>Class-1 <span class="math inline">\rightarrow</span> Class-0 errors (2025 cases) fewer and may correspond to moderate or cross-partisan language patterns.</p></li>
</ul>
<p>Given that embeddings are learned from scratch, the model relies heavily on dataset-specific word usage rather than external semantic priors, which can increase confusion in stylistically similar texts.</p>
<p>The false-positive rate is about twice the false-negative rate, showing that the classifier is more prone to labeling class-<span class="math inline">0</span> items as class <span class="math inline">1</span> than vice versa. In applications where mislabeling class <span class="math inline">0</span> has higher cost, this skew may require threshold adjustment or reweighting.</p>
</section>
<section id="comparative-perspective" class="level3">
<h3 class="anchored" data-anchor-id="comparative-perspective">Comparative perspective</h3>
<p>A BiLSTM with masked pooling is a strong sequential baseline. However, architectures initialized with pretrained contextual encoders typically outperform purely task-trained embeddings on political text tasks because they embed broader semantic and syntactic regularities. The present performance indicates that the dataset is large enough to train effective representations, but also hints at a ceiling imposed by the lack of pretrained knowledge.</p>
<div class="cell">
<div id="tbl-comp" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Model Comparison
</figcaption>
<div aria-describedby="tbl-comp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="daiisvxvyl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#daiisvxvyl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#daiisvxvyl thead, #daiisvxvyl tbody, #daiisvxvyl tfoot, #daiisvxvyl tr, #daiisvxvyl td, #daiisvxvyl th {
  border-style: none;
}

#daiisvxvyl p {
  margin: 0;
  padding: 0;
}

#daiisvxvyl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#daiisvxvyl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#daiisvxvyl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#daiisvxvyl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#daiisvxvyl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#daiisvxvyl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#daiisvxvyl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#daiisvxvyl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#daiisvxvyl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#daiisvxvyl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#daiisvxvyl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#daiisvxvyl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#daiisvxvyl .gt_spanner_row {
  border-bottom-style: hidden;
}

#daiisvxvyl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#daiisvxvyl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#daiisvxvyl .gt_from_md > :first-child {
  margin-top: 0;
}

#daiisvxvyl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#daiisvxvyl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#daiisvxvyl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#daiisvxvyl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#daiisvxvyl .gt_row_group_first td {
  border-top-width: 2px;
}

#daiisvxvyl .gt_row_group_first th {
  border-top-width: 2px;
}

#daiisvxvyl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#daiisvxvyl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#daiisvxvyl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#daiisvxvyl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#daiisvxvyl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#daiisvxvyl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#daiisvxvyl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#daiisvxvyl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#daiisvxvyl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#daiisvxvyl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#daiisvxvyl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#daiisvxvyl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#daiisvxvyl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#daiisvxvyl .gt_left {
  text-align: left;
}

#daiisvxvyl .gt_center {
  text-align: center;
}

#daiisvxvyl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#daiisvxvyl .gt_font_normal {
  font-weight: normal;
}

#daiisvxvyl .gt_font_bold {
  font-weight: bold;
}

#daiisvxvyl .gt_font_italic {
  font-style: italic;
}

#daiisvxvyl .gt_super {
  font-size: 65%;
}

#daiisvxvyl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#daiisvxvyl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#daiisvxvyl .gt_indent_1 {
  text-indent: 5px;
}

#daiisvxvyl .gt_indent_2 {
  text-indent: 10px;
}

#daiisvxvyl .gt_indent_3 {
  text-indent: 15px;
}

#daiisvxvyl .gt_indent_4 {
  text-indent: 20px;
}

#daiisvxvyl .gt_indent_5 {
  text-indent: 25px;
}

#daiisvxvyl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#daiisvxvyl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="9" class="gt_heading gt_title gt_font_normal">Model Comparison</th>
</tr>
<tr class="gt_heading even">
<th colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Cells highlighted indicate the winning model for that specific metric</th>
</tr>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Class" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Class</th>
<th colspan="4" id="BiLSTM" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
BiLSTM
</div></th>
<th colspan="4" id="Naive Bayes" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Naive Bayes
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Precision_BiLSTM" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Precision</th>
<th id="Recall_BiLSTM" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Recall</th>
<th id="F1_BiLSTM" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">F1</th>
<th id="Support_BiLSTM" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Support</th>
<th id="Precision_NB" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Precision</th>
<th id="Recall_NB" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Recall</th>
<th id="F1_NB" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">F1</th>
<th id="Support_NB" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Support</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Class">0</td>
<td class="gt_row gt_right" headers="Precision_BiLSTM" style="background-color: #D4F0D4">0.8347</td>
<td class="gt_row gt_right" headers="Recall_BiLSTM" style="background-color: #D4F0D4">0.8008</td>
<td class="gt_row gt_right" headers="F1_BiLSTM" style="background-color: #D4F0D4">0.8174</td>
<td class="gt_row gt_right" headers="Support_BiLSTM" style="border-right-width: 2px; border-right-style: solid; border-right-color: #d3d3d3">12770</td>
<td class="gt_row gt_right" headers="Precision_NB">0.8258</td>
<td class="gt_row gt_right" headers="Recall_NB">0.7517</td>
<td class="gt_row gt_right" headers="F1_NB">0.7870</td>
<td class="gt_row gt_right" headers="Support_NB">12770</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Class">1</td>
<td class="gt_row gt_right" headers="Precision_BiLSTM" style="background-color: #D4F0D4">0.8801</td>
<td class="gt_row gt_right" headers="Recall_BiLSTM">0.9021</td>
<td class="gt_row gt_right" headers="F1_BiLSTM" style="background-color: #D4F0D4">0.8910</td>
<td class="gt_row gt_right" headers="Support_BiLSTM" style="border-right-width: 2px; border-right-style: solid; border-right-color: #d3d3d3">20691</td>
<td class="gt_row gt_right" headers="Precision_NB">0.8548</td>
<td class="gt_row gt_right" headers="Recall_NB">0.9021</td>
<td class="gt_row gt_right" headers="F1_NB">0.8778</td>
<td class="gt_row gt_right" headers="Support_NB">20691</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Class">Accuracy</td>
<td class="gt_row gt_right" headers="Precision_BiLSTM" style="background-color: #D4F0D4">0.8635</td>
<td class="gt_row gt_right" headers="Recall_BiLSTM">-</td>
<td class="gt_row gt_right" headers="F1_BiLSTM">-</td>
<td class="gt_row gt_right" headers="Support_BiLSTM" style="border-right-width: 2px; border-right-style: solid; border-right-color: #d3d3d3">33461</td>
<td class="gt_row gt_right" headers="Precision_NB">0.8447</td>
<td class="gt_row gt_right" headers="Recall_NB">-</td>
<td class="gt_row gt_right" headers="F1_NB">-</td>
<td class="gt_row gt_right" headers="Support_NB">33461</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Class">Macro avg</td>
<td class="gt_row gt_right" headers="Precision_BiLSTM" style="background-color: #D4F0D4">0.8574</td>
<td class="gt_row gt_right" headers="Recall_BiLSTM" style="background-color: #D4F0D4">0.8515</td>
<td class="gt_row gt_right" headers="F1_BiLSTM" style="background-color: #D4F0D4">0.8542</td>
<td class="gt_row gt_right" headers="Support_BiLSTM" style="border-right-width: 2px; border-right-style: solid; border-right-color: #d3d3d3">33461</td>
<td class="gt_row gt_right" headers="Precision_NB">0.8403</td>
<td class="gt_row gt_right" headers="Recall_NB">0.8269</td>
<td class="gt_row gt_right" headers="F1_NB">0.8324</td>
<td class="gt_row gt_right" headers="Support_NB">33461</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Class">Weighted avg</td>
<td class="gt_row gt_right" headers="Precision_BiLSTM" style="background-color: #D4F0D4">0.8627</td>
<td class="gt_row gt_right" headers="Recall_BiLSTM" style="background-color: #D4F0D4">0.8635</td>
<td class="gt_row gt_right" headers="F1_BiLSTM" style="background-color: #D4F0D4">0.8629</td>
<td class="gt_row gt_right" headers="Support_BiLSTM" style="border-right-width: 2px; border-right-style: solid; border-right-color: #d3d3d3">33461</td>
<td class="gt_row gt_right" headers="Precision_NB">0.8437</td>
<td class="gt_row gt_right" headers="Recall_NB">0.8447</td>
<td class="gt_row gt_right" headers="F1_NB">0.8432</td>
<td class="gt_row gt_right" headers="Support_NB">33461</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="limitations-and-possible-extensions" class="level2">
<h2 class="anchored" data-anchor-id="limitations-and-possible-extensions">Limitations and possible extensions</h2>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ul>
<li><strong>No pretrained representations:</strong> learning <span class="math inline">E</span> from scratch can underutilize semantic information that pretrained models capture.</li>
<li><strong>Fixed truncation length:</strong> texts longer than 128 tokens lose tail content, potentially discarding discriminative cues.</li>
<li><strong>Moderate imbalance:</strong> the decision boundary shifts toward class <span class="math inline">1</span>, as seen in higher FPR.</li>
<li><strong>Pooling simplicity:</strong> mean pooling assumes equal importance of token positions and may dilute localized signals.</li>
</ul>
</section>
<section id="extensions" class="level3">
<h3 class="anchored" data-anchor-id="extensions">Extensions</h3>
<p>Several modifications could plausibly improve accuracy or reduce skew:</p>
<ul>
<li><strong>Class-weighted loss:</strong> set weights <span class="math inline">w_0,w_1</span> in cross-entropy to penalize minority errors more.</li>
<li><strong>Pretrained encoder swap:</strong> replace the embedding+BiLSTM block with a frozen or fine-tuned transformer encoder while keeping masked pooling and the head.</li>
<li><strong>Attention pooling:</strong> learn token weights <span class="math inline">\alpha_i</span> to compute <span class="math inline">\mathbf{z}=\sum_i \alpha_i \mathbf{h}_i</span> with masking.</li>
<li><strong>Longer or adaptive <span class="math inline">T</span>:</strong> increase <span class="math inline">T</span> or bucket by length to preserve more context without undue padding cost.</li>
<li><strong>Calibration and thresholding:</strong> tune the probability cutoff using validation curves to trade off FPR vs.&nbsp;FNR for downstream objectives.</li>
</ul>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The implemented pipeline offers a computationally efficient neural baseline for binary party attribution in political texts. By combining subword token IDs with trainable embeddings and a BiLSTM encoder, the system captures sequential patterns and achieves solid test performance (accuracy <span class="math inline">0.8635</span>, MCC <span class="math inline">0.7088</span>). Evaluation reveals a mild bias toward predicting the majority class, visible in an elevated false-positive rate for class <span class="math inline">0</span>. The model’s simplicity, GPU-friendly batching, and stable selection via validation accuracy make it a robust starting point. Future work should focus on incorporating pretrained contextual representations and imbalance-aware objectives to further improve minority-class recall and overall calibration.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>